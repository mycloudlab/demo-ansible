# Basic provisioning example
- name: Ansible test
  hosts: all
  tasks:
  - name: criar vpc para aplicação pet-clinic
    ec2_vpc_net:
      name: vpc_petclinic_dev
      cidr_block: 10.10.0.0/16
      region: us-east-2
      tags:
        app: pet clinic
        env: dev
      tenancy: dedicated
      register: vpcdata

  - name: cria a sub rede da aplicação
    amazon.aws.ec2_vpc_subnet:
      state: present
      vpc_id: "{{vpcdata.vpc.id}}"
      region: us-east-2
      cidr: 10.10.0.0/16
      tags:
        app: pet clinic
        env: dev
#     register: database_subnet


#  - name: launching AWS instance using Ansible
#    ec2:
#      key_name: aws_instance_Ansible
#      instance_type: t2.micro
#      image: ami-0abcb3d13703a4978
#      region: us-east-2
#      wait: yes
#      group: Ansible
#      count: 1
#      vpc_subnet_id: default
#      assign_public_ip: yes
#      aws_access_key: "{{ lookup('env', 'AWS_ACCESS_KEY_ID') }}"
#      aws_secret_key: "{{ lookup('env', 'AWS_SECRET_ACCESS_KEY') }}"